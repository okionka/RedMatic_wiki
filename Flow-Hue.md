Die Hue-Integration die die Homematic CCU mitbringt bietet leider keine Möglichkeit über langen Tastendruck eine Lampe auf/ab zu dimmen. Mit Hilfe dieses Flows kann dies dennoch realisiert werden. Hierfür werden die [Huemagic Nodes](https://flows.nodered.org/node/node-red-contrib-huemagic) benötigt (siehe [Installation zusätzlicher Nodes](https://github.com/hobbyquaker/RedMatic/wiki/Node-Installation)). 

![](images/hue-1.png)

_RPC Event Nodes_ werden so konfiguriert dass sie den `PRESS_CONT` Event einer Fernbedienungstaste ausgeben (dieser Event wird bei anhaltendem Tastendruck mehrfach pro Sekunde erzeugt).

![](images/hue-2.png)

Mit Hilfe eines _Change Nodes_ wird ein JSON Payload konfiguriert der die Lampe 12% heller bzw. dunkler dimmt.

![](images/hue-3.png)

## Flow JSON

```
[{"id":"304aba38.24ea26","type":"tab","label":"Hue","disabled":false,"info":""},{"id":"2a0eae22.276812","type":"ccu-rpc-event","z":"304aba38.24ea26","name":"FB1:1 PRESS_CONT","iface":"BidCos-RF","ccuConfig":"38263145.35ea0e","rooms":"","roomsRx":"str","functions":"","functionsRx":"str","device":"","deviceRx":"str","deviceName":"","deviceNameRx":"str","deviceType":"","deviceTypeRx":"str","channel":"","channelRx":"str","channelName":"FB1:1","channelNameRx":"str","channelType":"","channelTypeRx":"str","datapoint":"PRESS_CONT","datapointRx":"str","change":false,"working":false,"cache":false,"topic":"${CCU}/${Interface}/${channelName}/${datapoint}","x":120,"y":340,"wires":[["89e2668.d033598"]]},{"id":"441d58d9.119c88","type":"ccu-rpc-event","z":"304aba38.24ea26","name":"FB1:2 PRESS_CONT","iface":"BidCos-RF","ccuConfig":"38263145.35ea0e","rooms":"","roomsRx":"str","functions":"","functionsRx":"str","device":"","deviceRx":"str","deviceName":"","deviceNameRx":"str","deviceType":"","deviceTypeRx":"str","channel":"","channelRx":"str","channelName":"FB1:2","channelNameRx":"str","channelType":"","channelTypeRx":"str","datapoint":"PRESS_CONT","datapointRx":"str","change":false,"working":false,"cache":false,"topic":"${CCU}/${Interface}/${channelName}/${datapoint}","x":120,"y":380,"wires":[["7b177b7a.becc64"]]},{"id":"2ed698f2.c94958","type":"hue-light","z":"304aba38.24ea26","name":"Hobbyraum","bridge":"7d594bae.859ad4","lightid":"7","colornamer":true,"x":690,"y":280,"wires":[[]]},{"id":"7b177b7a.becc64","type":"change","z":"304aba38.24ea26","name":"{\"incrementBrightness\":12}","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"incrementBrightness\":12}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":380,"wires":[["2ed698f2.c94958"]]},{"id":"89e2668.d033598","type":"change","z":"304aba38.24ea26","name":"{\"incrementBrightness\":-12}","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"incrementBrightness\":-12}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":340,"wires":[["2ed698f2.c94958"]]},{"id":"510e271f.3258c8","type":"ccu-rpc-event","z":"304aba38.24ea26","name":"FB1:1 PRESS_SHORT","iface":"BidCos-RF","ccuConfig":"38263145.35ea0e","rooms":"","roomsRx":"str","functions":"","functionsRx":"str","device":"","deviceRx":"str","deviceName":"","deviceNameRx":"str","deviceType":"","deviceTypeRx":"str","channel":"","channelRx":"str","channelName":"FB1:1","channelNameRx":"str","channelType":"","channelTypeRx":"str","datapoint":"PRESS_SHORT","datapointRx":"str","change":false,"working":false,"cache":false,"topic":"${CCU}/${Interface}/${channelName}/${datapoint}","x":120,"y":180,"wires":[["ad3b7dd2.eb02"]]},{"id":"70b23ddd.944094","type":"ccu-rpc-event","z":"304aba38.24ea26","name":"FB1:2 PRESS_SHORT","iface":"BidCos-RF","ccuConfig":"38263145.35ea0e","rooms":"","roomsRx":"str","functions":"","functionsRx":"str","device":"","deviceRx":"str","deviceName":"","deviceNameRx":"str","deviceType":"","deviceTypeRx":"str","channel":"","channelRx":"str","channelName":"FB1:2","channelNameRx":"str","channelType":"","channelTypeRx":"str","datapoint":"PRESS_SHORT","datapointRx":"str","change":false,"working":false,"cache":false,"topic":"${CCU}/${Interface}/${channelName}/${datapoint}","x":120,"y":220,"wires":[["dd60c2c4.1f24d"]]},{"id":"ad3b7dd2.eb02","type":"change","z":"304aba38.24ea26","name":"false","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":180,"wires":[["2ed698f2.c94958"]]},{"id":"dd60c2c4.1f24d","type":"change","z":"304aba38.24ea26","name":"true","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":220,"wires":[["2ed698f2.c94958"]]},{"id":"5f4a7759.25cfc8","type":"comment","z":"304aba38.24ea26","name":"An/Aus","info":"","x":70,"y":140,"wires":[]},{"id":"d46def92.34cd3","type":"comment","z":"304aba38.24ea26","name":"Dimmen","info":"","x":80,"y":300,"wires":[]},{"id":"38263145.35ea0e","type":"ccu-connection","z":"","name":"localhost","host":"localhost","regaEnabled":true,"bcrfEnabled":true,"iprfEnabled":true,"virtEnabled":true,"bcwiEnabled":false,"cuxdEnabled":false,"regaPoll":true,"regaInterval":"30","rpcPingTimeout":"60","rpcInitAddress":"127.0.0.1","rpcServerHost":"127.0.0.1","rpcBinPort":"2047","rpcXmlPort":"2048"},{"id":"7d594bae.859ad4","type":"hue-bridge","z":"","name":"Philips hue","bridge":"172.16.18.103","key":"...","interval":"30000"}]
```